//
// Created by user on 3/26/23.
//

#include "Graph.h"


Graph::Graph() {
    size = 0;
}


void Graph::addVertex(int data) {
    if (GraphIterator(this).find(data)) {
        return;
    }

    auto* vertex = new Vertex(data);
    list.push(vertex);
    size++;
}


bool Graph::addEdge(Vertex* from_vertex, Vertex* to_vertex, bool is_directed) {
    if (!from_vertex || !to_vertex) {
        return false;
    }

    if (from_vertex->findEdge(to_vertex) || to_vertex->findEdge(from_vertex)) {
        return false;
    }

    auto* edge = new Edge(from_vertex, to_vertex, is_directed);
    from_vertex->appendEdge(edge);
    to_vertex->appendEdge(edge);
    return true;
}


bool Graph::addEdge(int from_data, int to_data, bool is_directed) {
    Vertex* from_vertex = GraphIterator(this).find(from_data);
    Vertex* to_vertex = GraphIterator(this).find(to_data);

    if (!from_vertex || !to_vertex) {
        return false;
    }

    return addEdge(from_vertex, to_vertex, is_directed);
}


uint64_t Graph::getVertexNumber() const {
    return size;
}


void Graph::printVertices() {
    auto* node = list.getHead();
    while (node != list.getTail()) {
        std::cout << node->getNodeObject()->get() << ", ";
        node = node->getNext();
    }
    std::cout << node->getNodeObject()->get() << std::endl;
}


void Graph::printEdges() {
    GraphIterator iterator(this, list.getHead()->getNodeObject());

    while (iterator.getVertex()) {
        auto* vertex = iterator.getVertex();
        std::cout << vertex->get() << " : " << std::endl;

        ListIterator<Edge*> edge_iterator(&vertex->edge_list, vertex->edge_list.getHead());
        for (int i = 0; i < vertex->edge_list.getSize(); i++) {
            std::cout << "    " << edge_iterator.get()->getStart()->get();
            (edge_iterator.get()->getIsDirected()) ? std::cout << " <--> " : std::cout << "  --> ";
            std::cout << edge_iterator.get()->getEnd()->get() << std::endl;
            edge_iterator.shiftToTail();
        }
        iterator.shiftToTail();
    }
}


Vertex* Graph::find(int data) {
    return GraphIterator(this).find(data);
}


void Graph::delVertex(int data) {
    GraphIterator del_iterator(this);
    GraphIterator iterator(this, list.getHead()->getNodeObject());

    if (del_iterator.find(data) == nullptr) {
        return;
    }

    while (iterator.getVertex() != nullptr) {
        delEdge(del_iterator.find(data), iterator.getVertex());
        iterator.shiftToTail();
    }

    del_iterator.deleteVertex();
    size--;
}


void Graph::delEdge(Vertex* vertex1, Vertex* vertex2) {
    if (!vertex1 || !vertex2) {
        return;
    }

    vertex1->delEdge(vertex2);
    vertex2->delEdge(vertex1);
}


void Graph::delEdge(int data1, int data2) {
    Vertex* vertex1 = GraphIterator(this).find(data1);
    Vertex* vertex2 = GraphIterator(this).find(data2);

    delEdge(vertex1, vertex2);
}
